## 4.2. Vue 3 Composition API

### setup() Function

`setup()` — головна функція для ініціалізації логіки компонента у Composition API.

```js
import { ref } from "vue";
export default {
    setup() {
        const count = ref(0);
        function increment() {
            count.value++;
        }
        return { count, increment };
    },
};
```

-   Викликається перед створенням компонента.
-   Повертає об'єкти та функції для шаблону.

---

### Reactive References (ref, reactive)

`ref` — створює реактивне примітивне значення.
`reactive` — створює реактивний об'єкт.

```js
import { ref, reactive } from "vue";
const name = ref("Anna");
const user = reactive({ age: 28 });
```

-   Доступ до значення через `.value` для `ref`.
-   `reactive` — для складних структур.

---

### Computed and Watch

`computed` — обчислювані властивості.
`watch` — спостерігачі за змінами.

```js
import { ref, computed, watch } from "vue";
const a = ref(1);
const b = ref(2);
const sum = computed(() => a.value + b.value);
watch(a, (newVal) => {
    console.log("a changed:", newVal);
});
```

-   `computed` кешується.
-   `watch` для побічних ефектів.

---

### Lifecycle Hooks

Хуки життєвого циклу — функції для роботи на різних етапах компонента.

```js
import { onMounted, onUpdated, onUnmounted } from 'vue';
setup() {
  onMounted(() => { console.log('Mounted!'); });
  onUpdated(() => { console.log('Updated!'); });
  onUnmounted(() => { console.log('Unmounted!'); });
}
```

-   Основні: `onMounted`, `onUpdated`, `onUnmounted`, `onBeforeMount`, `onBeforeUpdate`, `onBeforeUnmount`.

---

### Template Refs

Template refs — доступ до DOM-елементів у шаблоні.

```html
<template>
    <input ref="inputRef" />
</template>
<script setup>
    import { ref, onMounted } from "vue";
    const inputRef = ref(null);
    onMounted(() => {
        inputRef.value.focus();
    });
</script>
```

-   Використовуйте для інтеракції з DOM.

---

### provide/inject

`provide` — передає дані вниз по дереву компонентів.
`inject` — отримує ці дані у дочірньому компоненті.

```js
// Parent.vue
import { provide } from 'vue';
setup() {
  provide('theme', 'dark');
}
// Child.vue
import { inject } from 'vue';
setup() {
  const theme = inject('theme');
}
```

-   Зручно для глобальних налаштувань.

---

### Composables and Reusability

Composables — функції для повторного використання логіки.

```js
// useCounter.js
import { ref } from 'vue';
export function useCounter() {
  const count = ref(0);
  function increment() { count.value++; }
  return { count, increment };
}
// Component.vue
import { useCounter } from './useCounter';
setup() {
  const { count, increment } = useCounter();
}
```

-   Дозволяють ділити логіку між компонентами.
-   Підтримують чистий, масштабований код.

---

### Mermaid Diagram: Composition API

```mermaid
graph TD
    A[setup()] --> B[ref/reactive]
    B --> C[computed]
    B --> D[watch]
    E[Lifecycle] --> F[onMounted]
    G[Template Ref] --> H[inputRef]
    I[provide] --> J[inject]
    K[Composables] --> L[useCounter]
```

_Composition API у Vue 3_

---

#### Navigation

-   [Попередня тема: Vue 3 Fundamentals](4.1-vue3-fundamentals.md)
-   [Наступна тема: Vue 3 Advanced](4.3-vue3-advanced.md)
